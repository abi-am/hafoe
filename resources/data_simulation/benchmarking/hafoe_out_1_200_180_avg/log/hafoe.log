
Configuration successful
===================================================================

hafoe will execute with the following parameters:
	explore = TRUE 
	identify = FALSE 
	scripts.dir = ./src 
	bowtie.build.path = /usr/bin/bowtie2-build 
	bowtie.align.path = /usr/bin/bowtie2 
	samtools.path = /usr/bin/samtools 
	cd_hit_est.path = /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
	cd_hit_est_2d.path = /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est-2d 
	clustalo.path = /usr/bin/clustalo 
	parent.path = input_files/AAV_all16_new.fasta 
	chimeric.lib.path = input_files/data1/Chimeric_lib_simulated_ccs.csv 
	enriched.path = input_files/data1/Enriched_lib_simulated_ccs.fastq.gz 
	output.dir =  benchmarking/hafoe_out_1_200_180_avg 
	rlib =  /home/tatevik/R/x86_64-pc-linux-gnu-library/4.1 
	num.proc = 4 
	read_length = 200 
	overlap = TRUE 
	step_size = 180 
	vd_criterion = avg 

Checking and installing dependencies
===================================================================

Following R packages were installed in /home/tatevik/R/x86_64-pc-linux-gnu-library/4.1 directory and/or called:
	dplyr: version 1.0.9
	ORFik: version 1.12.13
	plotly: version 4.10.0
	ggplot2: version 3.3.6
	gplots: version 3.1.3
	microseq: version 2.1.4
	Biostrings: version 2.60.2
	stringr: version 1.4.0
	cowplot: version 1.1.1
	seqinr: version 4.2.8


Filtering the input libraries by ORF and original sequence lengths
===================================================================

Filtering the chimeric library
-------------------------------------------------------------------
File: input_files/data1/Chimeric_lib_simulated_ccs.fasta
Minimum ORF length: 600
Maximum sequence length: 3000
Number of sequences before filtering: 3201
Number of sequences after filtering: 24
ORF length summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1830    1913    1928    1971    2043    2205 

Filtering the enrichment cycle 1 library
-------------------------------------------------------------------
File: input_files/data1/Enriched_lib_simulated_ccs.fastq.gz
Minimum ORF length: 600
Maximum sequence length: 3000
Number of sequences before filtering: 1137
Number of sequences after filtering: 10
ORF length summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1824    1859    2124    2039    2168    2214 



Clustering the filtered chimeric library
===================================================================

Program: cd-hit-est
Command: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
	 -i benchmarking/hafoe_out_1_200_180_avg/files/Chimeric_ORF.fasta 
	 -o benchmarking/hafoe_out_1_200_180_avg/files/clstr_chimeric_lib/clstr_chim.fasta 
	 -g 1 
	 -d 100 
	 -c 0.9 
	 -n 9 
	 -G 0 
	 -aL 0.9 
cd-hit-est path: /storage2/proj/kodikaz/softwares/cdhit/cd-hit-est 
Input path: benchmarking/hafoe_out_1_200_180_avg/files/Chimeric_ORF.fasta 
Output path: benchmarking/hafoe_out_1_200_180_avg/files/clstr_chimeric_lib 
Log path: benchmarking/hafoe_out_1_200_180_avg/log/cd_hit_est.log 
Sequence identity threshold, default 0.9 (-c): 0.9 
Identity type, default 1 (-G):  0 
	(if set to 1, use global sequence identity, 
	if set to 0, then use local sequence identity, 
	calculated as number of identical bases in alignment
	divided by the length of the alignment) 
Alignment coverage for the longer sequence, default 0.0 (-aL): 0.9 
word_length, default 10, see CD-HIT user's guide for choosing it (-n): 9 

Number of clusters: 14
Cluster size summary statistics
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   1.500   1.714   2.000   5.000 


Choosing new representative sequences for the clusters
===================================================================

Choosing a new representative ORF sequence for each cluster based on: 
	1. greatest sequence abundance in the input chimeric library
	2. maximum ORF length
Output path: benchmarking/hafoe_out_1_200_180_avg/files/clstr_chimeric_lib/clstr_chim_new.fasta


Plotting the cluster size distribution
===================================================================

Output path: benchmarking/hafoe_out_1_200_180_avg/reports/cluster_size_distr_chimeric_lib.pdf


Building index on parental library
===================================================================

Command: /usr/bin/bowtie2-build 
	 input_files/AAV_all16_new.fasta  
	 benchmarking/hafoe_out_1_200_180_avg/files/parent_index/AAV 
bowtie2-build path: /usr/bin/bowtie2-build 
Input path: input_files/AAV_all16_new.fasta 
Output path: benchmarking/hafoe_out_1_200_180_avg/files/parent_index 
Log path: benchmarking/hafoe_out_1_200_180_avg/log/bowtie_build.log 


Doing variant description on chimeric library representatives
===================================================================


Making fastq files for chimeric library representatives
-------------------------------------------------------------------

Chopping each representative sequence into fragments of fixed size and storing into fastq files 
Fragment length: 200
Use overlapping fragments (TRUE/FALSE): TRUE
Step size: 180
Output path: benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/fastq


Aligning chimeric library representatives on parental index
-------------------------------------------------------------------

Command: /usr/bin/bowtie2 
	 -p 4 
	 -a 
	 --no-unal 
	 -L 30 
	 -D 2 
	 -x benchmarking/hafoe_out_1_200_180_avg/files/parent_index/AAV  
	 --un benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/unmapped/.fq 
	 -S benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/sam/.sam 
bowtie2 path: /usr/bin/bowtie2 
Reference index path: benchmarking/hafoe_out_1_200_180_avg/files/parent_index/AAV 
Output path for mapped reads: benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/bam 
Output path for unmapped reads: benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/unmapped 
Log path: benchmarking/hafoe_out_1_200_180_avg/log/bowtie_align_representatives.log 
Seed length (-L): 30 
Number of seed extention failed attemps, default 15 (-D): 2 
	(Up to <int> consecutive seed extension attempts can fail
	before Bowtie 2 moves on, using the alignments found so far. 
	A seed extension fails if it does not yield a new best or
	a new second-best alignment. This limit is automatically 
	adjusted up when -k or -a are specified.) 

Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 1 seconds

Running...: 50% done
Elapsed Time: 2 seconds

Running...: 75% done
Elapsed Time: 3 seconds

Running...: 100% done
Elapsed Time: 4 seconds


Getting required files for variant description
-------------------------------------------------------------------


Processing mapped reads


Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 0 seconds

Running...: 50% done
Elapsed Time: 1 seconds

Running...: 75% done
Elapsed Time: 1 seconds

Running...: 100% done
Elapsed Time: 1 seconds


Processing unmapped reads


Running...: 0% done
Elapsed Time: 0 seconds

Running...: 25% done
Elapsed Time: 0 seconds

Running...: 50% done
Elapsed Time: 0 seconds

Running...: 75% done
Elapsed Time: 0 seconds

Running...: 100% done
Elapsed Time: 0 seconds


Doing neighbor-aware serotype identification
-------------------------------------------------------------------

Output path: benchmarking/hafoe_out_1_200_180_avg/files/variant_description/chimeric_lib_representatives/chimeric_lib_representatives_variant_description.csv

Abundance of AAV serotypes in the chimeric library
                   Freq(%)
AAV2                 23.26
AAV6                 19.26
AAVrh8               18.16
AAV13                 8.31
AAV8                  6.91
no alignment          5.27
AAV5                  5.07
AAV1                  4.03
AAV9                  3.68
AAV3                  2.33
AAV7                  1.39
multiple alignment    1.21
AAVrh10               1.12
AAV4                  0.00
AAV10                 0.00
AAV11                 0.00
AAV12                 0.00
AAVrh32               0.00


Plotting the cluster abundance
===================================================================

Output path: benchmarking/hafoe_out_1_200_180_avg/reports/cluster_abundance_chimeric_lib.pdf


Plotting variant description of chimeric library representatives
===================================================================

Output path: benchmarking/hafoe_out_1_200_180_avg/reports/variant_description_chimeric_rep.pdf


Plotting distribution of AAV serotypes in chimeric library
based on variant description of representatives and their
abundance the chimeric library
===================================================================

Output path: benchmarking/hafoe_out_1_200_180_avg/reports/serotype_distribution_chimeric_lib.pdf
